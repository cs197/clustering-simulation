(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     50216,       1055]
NotebookOptionsPosition[     47884,        973]
NotebookOutlinePosition[     48240,        989]
CellTagsIndexPosition[     48197,        986]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Dynamic Clustering", "Title",
 CellChangeTimes->{{3.680783261681829*^9, 3.680783265021587*^9}, {
  3.68096235770054*^9, 3.680962364238274*^9}, {3.680963296790612*^9, 
  3.680963299030604*^9}}],

Cell["\<\
In K-Means Clustering, the number of clusters, K is hard-coded. By contrast, \
the goal of this simulation is to have the number of clusters emerge \
dynamically.\
\>", "Text",
 CellChangeTimes->{{3.680962439930032*^9, 3.680962595852531*^9}, {
  3.680963037335271*^9, 3.68096306188231*^9}, {3.680963217873681*^9, 
  3.680963221305058*^9}, {3.680963303564657*^9, 3.680963362075468*^9}, {
  3.6809646623663673`*^9, 3.680964665798918*^9}}],

Cell[CellGroupData[{

Cell["Simulation Constants", "Chapter",
 CellChangeTimes->{{3.680783286758191*^9, 3.680783294271393*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"steps", "=", "50"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"--", " ", "The"}], " ", "number", " ", "of", " ", "times", " ", 
    "the", " ", "core", " ", "Do", " ", "statement", " ", "calls", " ", 
    RowBox[{"update", "."}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.680554438896204*^9, 3.680554440999096*^9}, {
   3.680555416822051*^9, 3.680555465633183*^9}, {3.680555655224381*^9, 
   3.680555657283454*^9}, {3.680555867620885*^9, 3.6805558813587837`*^9}, {
   3.680634391216004*^9, 3.680634394266315*^9}, {3.6806346591645517`*^9, 
   3.680634676589086*^9}, {3.680634809957344*^9, 3.680634835303033*^9}, {
   3.68063586644027*^9, 3.680635866539359*^9}, 3.680783303733281*^9, {
   3.6809160730898743`*^9, 3.680916101562154*^9}, {3.680962626744956*^9, 
   3.680962672093843*^9}, {3.680962714697444*^9, 3.6809627151248913`*^9}, {
   3.680962753432637*^9, 3.680962810502034*^9}, {3.680970671220233*^9, 
   3.680970671467659*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"actorCount", "=", "500"}], ";"}]], "Input",
 CellChangeTimes->{{3.680783707106249*^9, 3.680783716382255*^9}, {
   3.680783837567141*^9, 3.680783838860629*^9}, {3.6809154282172203`*^9, 
   3.680915428398555*^9}, 3.680915990132661*^9, {3.680916105634604*^9, 
   3.680916106714457*^9}, {3.680962960092682*^9, 3.680962961881459*^9}, {
   3.680963049709772*^9, 3.6809630501034193`*^9}, 3.680963375310004*^9, 
   3.680970665517631*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dimension", "=", "2"}], ";"}]], "Input",
 CellChangeTimes->{{3.6807837475417223`*^9, 3.6807837501884537`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"clusterCount", "=", "4"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"--", " ", "The"}], " ", "K", " ", "in", " ", 
    "\"\<K-Means Clustering.\>\""}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.680784201614644*^9, 3.680784209986434*^9}, {
   3.6809623740822487`*^9, 3.680962412658683*^9}, 3.6809626813189383`*^9, {
   3.680962913283239*^9, 3.680962913596648*^9}, {3.680970733074024*^9, 
   3.6809707332187023`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"lowerAttribute", "=", 
    RowBox[{"-", "1"}]}], ";", " ", 
   RowBox[{"upperAttribute", "=", "1"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"--", " ", "The"}], " ", "range", " ", "of", " ", "the", " ", 
    RowBox[{"attributes", "."}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.680907608714654*^9, 3.680907640106286*^9}, {
  3.680907716426272*^9, 3.68090771660618*^9}, {3.680962881556664*^9, 
  3.680962898352933*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Drawing Constants", "Chapter",
 CellChangeTimes->{{3.680783286758191*^9, 3.680783294271393*^9}, {
  3.680907686828833*^9, 3.680907689032138*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"updateInterval", "=", "1.0"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"--", " ", "The"}], " ", "number", " ", "of", " ", "seconds", " ",
     "between", " ", 
    RowBox[{"redraws", "."}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.680554513169273*^9, 3.6805545162949038`*^9}, {
   3.680555617820176*^9, 3.6805556218495073`*^9}, 3.680783300797254*^9, {
   3.6809626053139153`*^9, 3.680962621221483*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"resolution", "=", "50"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"--", " ", "The"}], " ", "attributes", " ", "are", " ", "real", 
    " ", 
    RowBox[{"numbers", ".", " ", "This"}], " ", "controls", " ", "how", " ", 
    "we", " ", "bin", " ", "them", " ", "for", " ", 
    RowBox[{"display", "."}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.680785297632104*^9, 3.680785331463575*^9}, {
  3.680962828051888*^9, 3.68096285702075*^9}, {3.680962957225515*^9, 
  3.680962957325419*^9}, {3.6809630549300613`*^9, 3.680963055638568*^9}, {
  3.680963129777403*^9, 3.680963149755527*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"clusterColors", "=", 
   RowBox[{"Take", "[", 
    RowBox[{
     RowBox[{"ColorData", "[", 
      RowBox[{"1", ",", "\"\<ColorList\>\""}], "]"}], ",", "clusterCount"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.680906987665717*^9, 3.6809070748290873`*^9}, 
   3.680908016869857*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Initialization", "Chapter",
 CellChangeTimes->{{3.680783286758191*^9, 3.680783322497149*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"actorAttributes", "[", "]"}], ":=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lowerAttribute", ",", "upperAttribute"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"actorCount", ",", "dimension"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6807838268947353`*^9, 3.680783875828369*^9}, {
   3.680784128055522*^9, 3.6807841739868727`*^9}, 3.680784242523572*^9, {
   3.6807843621685762`*^9, 3.680784369436102*^9}, {3.680784518866404*^9, 
   3.680784528935018*^9}, {3.680784567252679*^9, 3.680784573789653*^9}, {
   3.680784795730068*^9, 3.680784813930965*^9}, {3.680907596885613*^9, 
   3.680907601012882*^9}, {3.680907645521043*^9, 3.6809076483449097`*^9}, {
   3.680914353081697*^9, 3.680914376839992*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"actorAllegiances", "[", "]"}], ":=", 
   RowBox[{"RandomInteger", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "clusterCount"}], "}"}], ",", "actorCount"}], "]"}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.680784246711053*^9, 3.680784280107874*^9}, 
   3.680784376636979*^9, {3.68078443322176*^9, 3.680784437067565*^9}, {
   3.680784468680224*^9, 3.680784496411529*^9}, 3.6807845339300137`*^9, {
   3.68078462523641*^9, 3.6807846253249063`*^9}, {3.6807849873508987`*^9, 
   3.680784988990863*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"initialize", "[", "]"}], ":=", 
  RowBox[{"Partition", "[", 
   RowBox[{
    RowBox[{"Riffle", "[", 
     RowBox[{
      RowBox[{"actorAttributes", "[", "]"}], ",", 
      RowBox[{"actorAllegiances", "[", "]"}]}], "]"}], ",", "2"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.680554885620805*^9, 3.6805549298825293`*^9}, 
   3.680634283484407*^9, {3.680784998555851*^9, 3.6807850145629797`*^9}, {
   3.680785068485772*^9, 3.680785071667904*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Updating", "Chapter",
 CellChangeTimes->{{3.680783286758191*^9, 3.680783334940096*^9}, {
  3.680783489323697*^9, 3.680783489773634*^9}}],

Cell[CellGroupData[{

Cell["Calculation of Cluster Means", "Section",
 CellChangeTimes->{{3.6809147600827312`*^9, 3.680914766246356*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"allowEmptyMean", "[", "attributesList_", "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"attributesList", "\[Equal]", 
     RowBox[{"{", "}"}]}], ",", 
    RowBox[{"Table", "[", 
     RowBox[{"0.0", ",", "dimension"}], "]"}], ",", 
    RowBox[{"Mean", "[", "attributesList", "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6809124644358177`*^9, 3.680912489611031*^9}, {
   3.680912550643461*^9, 3.680912600178905*^9}, 3.6809127275174637`*^9, 
   3.680912807617347*^9, {3.680915365656138*^9, 3.68091537198208*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"clusterMean", "[", 
   RowBox[{"actors_", ",", "i_"}], "]"}], ":=", 
  RowBox[{"allowEmptyMean", "[", 
   RowBox[{
    RowBox[{"Select", "[", 
     RowBox[{"actors", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "i"}], "&"}]}], "]"}], 
    "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.680911953866871*^9, 3.680912010047455*^9}, 
   3.680912097539914*^9, {3.680912177662263*^9, 3.680912183230986*^9}, {
   3.680912378012865*^9, 3.680912398263007*^9}, {3.680912756362398*^9, 
   3.6809127621192417`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"clusterMeans", "[", "actors_", "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"clusterMean", "[", 
     RowBox[{"actors", ",", "i"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "clusterCount"}], "}"}]}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.68091187870982*^9, 3.680911949634959*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Updating of Actors", "Section",
 CellChangeTimes->{{3.6809147600827312`*^9, 3.680914781028672*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"favoredCluster", "[", 
   RowBox[{"attributes_", ",", "means_"}], "]"}], ":=", 
  RowBox[{"First", "[", 
   RowBox[{"Ordering", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"EuclideanDistance", "[", 
       RowBox[{"attributes", ",", "mean"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"mean", ",", "means"}], "}"}]}], "]"}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.680913338344488*^9, 3.68091337702041*^9}, {
  3.6809137165800467`*^9, 3.68091373851619*^9}, {3.680913892417472*^9, 
  3.680913942309739*^9}, {3.680914311490563*^9, 3.680914316892417*^9}, {
  3.680914524250287*^9, 3.6809145315873623`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"updatedActor", "[", 
   RowBox[{"anyActor_", ",", "means_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"attributes", "=", 
      RowBox[{"anyActor", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"attributes", ",", 
      RowBox[{"favoredCluster", "[", 
       RowBox[{"attributes", ",", "means"}], "]"}]}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.680913221401943*^9, 3.680913332043088*^9}, 
   3.680913952232346*^9, 3.680914233877026*^9, {3.680914423832706*^9, 
   3.6809144521846857`*^9}, 3.680914484751234*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"update", "[", "actors_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"means", "=", 
       RowBox[{"clusterMeans", "[", "actors", "]"}]}], ",", 
      RowBox[{"randomPosition", "=", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{"1", ",", "actorCount"}], "}"}], "]"}]}]}], "}"}], ",", 
    RowBox[{"ReplacePart", "[", 
     RowBox[{"actors", ",", 
      RowBox[{"randomPosition", "\[Rule]", 
       RowBox[{"updatedActor", "[", 
        RowBox[{
         RowBox[{"actors", "[", 
          RowBox[{"[", "randomPosition", "]"}], "]"}], ",", "means"}], 
        "]"}]}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.680554885620805*^9, 3.680554954479945*^9}, {
   3.680634257234599*^9, 3.680634271634776*^9}, {3.680634488457037*^9, 
   3.680634517043026*^9}, {3.680634559118107*^9, 3.680634562873988*^9}, {
   3.680785137988139*^9, 3.6807851438718967`*^9}, {3.680911195539036*^9, 
   3.680911200513064*^9}, {3.680912858600411*^9, 3.68091295782401*^9}, {
   3.680913021399169*^9, 3.680913033918696*^9}, {3.680913065272547*^9, 
   3.680913136576622*^9}, {3.680913175106799*^9, 3.6809132089831553`*^9}, {
   3.6809139921825657`*^9, 3.6809140220835*^9}, 3.680914610145802*^9, {
   3.680914989571767*^9, 3.68091499304673*^9}, {3.6809159341066647`*^9, 
   3.68091593974284*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"x", "=", 
  RowBox[{"{", 
   RowBox[{"5", ",", "6"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.6809683880917187`*^9, 3.680968394126213*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"5", ",", "6"}], "}"}]], "Output",
 CellChangeTimes->{
  3.680968394973219*^9, {3.680970654395074*^9, 3.680970674827063*^9}, 
   3.680970735226313*^9, 3.680973763280822*^9, 3.680978356171988*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ReplacePart", "[", 
  RowBox[{"x", ",", 
   RowBox[{"1", "\[Rule]", "6"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.68096839748673*^9, 3.680968416580985*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"6", ",", "6"}], "}"}]], "Output",
 CellChangeTimes->{
  3.680968417264247*^9, {3.680970654413629*^9, 3.680970674846086*^9}, 
   3.680970735261621*^9, 3.6809737633109703`*^9, 3.680978356215868*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["x"], "Input",
 CellChangeTimes->{3.680968422596573*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"5", ",", "6"}], "}"}]], "Output",
 CellChangeTimes->{
  3.680968423297159*^9, {3.6809706544460163`*^9, 3.680970674878735*^9}, 
   3.680970735294715*^9, 3.680973763329121*^9, 3.68097835626602*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Drawing", "Chapter",
 CellChangeTimes->{{3.680783286758191*^9, 3.680783334940096*^9}, {
  3.68078346573407*^9, 3.6807834802786007`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"drawingPosition", "[", "x_", "]"}], ":=", 
  RowBox[{"Round", "[", 
   RowBox[{
    RowBox[{"resolution", "*", 
     FractionBox[
      RowBox[{"x", "-", "lowerAttribute"}], 
      RowBox[{"upperAttribute", "-", "lowerAttribute"}]]}], "+", "0.5"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.68090732427769*^9, 3.680907380963027*^9}, {
  3.680907471223205*^9, 3.680907496691716*^9}, {3.6809075863443403`*^9, 
  3.680907592372962*^9}, {3.680907651404858*^9, 3.6809076589987097`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"actorPosition", "[", "actor_", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"drawingPosition", "[", 
     RowBox[{"actor", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], ",", 
    RowBox[{"drawingPosition", "[", 
     RowBox[{"actor", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "2"}], "]"}], "]"}], "]"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.680907254089395*^9, 3.6809073205284224`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"actorAllegiance", "[", "actor_", "]"}], ":=", 
  RowBox[{"actor", "[", 
   RowBox[{"[", "2", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.680907152298757*^9, 3.6809071674949503`*^9}, 
   3.680907227514965*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"actorColor", "[", "actor_", "]"}], ":=", 
  RowBox[{"clusterColors", "[", 
   RowBox[{"[", 
    RowBox[{"actorAllegiance", "[", "actor", "]"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.680907152298757*^9, 3.6809071674949503`*^9}, {
  3.68090720089774*^9, 3.6809072190992527`*^9}, {3.6809079794075336`*^9, 
  3.6809079889569483`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"sparseArrayEntry", "[", "actor_", "]"}], ":=", 
  RowBox[{
   RowBox[{"actorPosition", "[", "actor", "]"}], "\[Rule]", 
   RowBox[{"actorColor", "[", "actor", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.680785576930182*^9, 3.680785579323176*^9}, {
   3.680785652370883*^9, 3.680785711026805*^9}, 3.680785984594105*^9, {
   3.6807866863790207`*^9, 3.680786687997428*^9}, {3.680786799036271*^9, 
   3.6807868006897287`*^9}, {3.68090622775427*^9, 3.6809062379750013`*^9}, {
   3.680907104901775*^9, 3.680907131596416*^9}, {3.680907233869895*^9, 
   3.680907244523548*^9}, {3.680907781113888*^9, 3.680907784421082*^9}, {
   3.680907895831297*^9, 3.680907899137353*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"represent", "[", "actors_", "]"}], ":=", 
  RowBox[{"Map", "[", 
   RowBox[{"sparseArrayEntry", ",", "actors"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.680785428553822*^9, 3.680785566003766*^9}, {
   3.680785992658849*^9, 3.6807860013663187`*^9}, 3.680907902594345*^9, {
   3.680911253804253*^9, 3.6809112555480347`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"draw", "[", 
   RowBox[{"actors_", ",", "t_"}], "]"}], ":=", 
  RowBox[{"ArrayPlot", "[", 
   RowBox[{"SparseArray", "[", 
    RowBox[{"represent", "[", "actors", "]"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.680554885620805*^9, 3.68055496526864*^9}, {
   3.680555739853765*^9, 3.68055574246349*^9}, {3.680634306880855*^9, 
   3.680634321089467*^9}, {3.680634753876412*^9, 3.6806347948036203`*^9}, {
   3.6806361427848053`*^9, 3.680636145494515*^9}, {3.680785210113563*^9, 
   3.6807852668213463`*^9}, {3.680785399145192*^9, 3.680785424275879*^9}, {
   3.680785504400091*^9, 3.6807855183605957`*^9}, 3.680785752765932*^9, {
   3.680786082006431*^9, 3.680786087518201*^9}, {3.6807866689079523`*^9, 
   3.68078667287885*^9}, {3.680911256976858*^9, 3.680911259013035*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Running", "Chapter",
 CellChangeTimes->{{3.680783286758191*^9, 3.680783334940096*^9}, {
  3.68078346573407*^9, 3.680783509303279*^9}}],

Cell["\<\
The dynamic module will not run until the entire notebook has been evaluated. \
Sigh.\
\>", "Text",
 CellChangeTimes->{{3.6809092276326714`*^9, 3.680909243013692*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DynamicModule", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"t", "=", 
      RowBox[{"-", "1"}]}], ",", "actors"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Dynamic", "[", 
    RowBox[{"Refresh", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"t", "<", "0"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"actors", "=", 
           RowBox[{"initialize", "[", "]"}]}], ";", 
          RowBox[{"t", "=", "0"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"actors", "=", 
             RowBox[{"update", "[", "actors", "]"}]}], ";", 
            RowBox[{"t", "=", 
             RowBox[{"t", "+", "1"}]}]}], ",", "steps"}], "]"}]}], 
        "\[IndentingNewLine]", "]"}], ";", 
       RowBox[{"draw", "[", 
        RowBox[{"actors", ",", "t"}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"TrackedSymbols", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"UpdateInterval", "\[Rule]", "updateInterval"}]}], "]"}], 
    "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.680554172744178*^9, 3.680554260998535*^9}, {
  3.6805542998918743`*^9, 3.680554314694853*^9}, {3.6805543896465483`*^9, 
  3.680554436610601*^9}, {3.680554521707082*^9, 3.680554626162971*^9}, {
  3.68055486539363*^9, 3.680554865740766*^9}, {3.6805555233578053`*^9, 
  3.680555532271282*^9}, {3.680634595974021*^9, 3.680634597805895*^9}, {
  3.680785223500637*^9, 3.6807852631431303`*^9}, {3.680911206522377*^9, 
  3.6809112204148006`*^9}, {3.6809682853410177`*^9, 3.6809683343108597`*^9}}],

Cell[BoxData[
 DynamicModuleBox[{$CellContext`t$$ = 
  250, $CellContext`actors$$ = {{{-0.48832006791974036`, -0.5539329983540493},
     4}, {{0.9182263270312223, -0.9550853697049684}, 3}, {{0.8984839655927499,
     0.8986125228797794}, 1}, {{-0.7267846414245436, -0.015292951747638561`}, 
    2}, {{0.5024849441448436, 0.9013151484394006}, 1}, {{-0.7885600270009303, 
    0.23487760736797947`}, 1}, {{0.3670207724502643, -0.4898514908429057}, 
    4}, {{-0.32187611075896205`, -0.6969399698185246}, 1}, {{
    0.9148897037240946, -0.5286748377172983}, 1}, {{0.7869598391534325, 
    0.7455855888791958}, 1}, {{0.7931509840805364, 0.28931173142587996`}, 
    3}, {{-0.044803736018836915`, -0.4680755353019692}, 
    3}, {{-0.37590121014489464`, 0.29245392210951904`}, 
    2}, {{-0.9170564680467796, -0.7727759968256667}, 4}, {{
    0.45736744412092856`, -0.48916421619934836`}, 1}, {{
    0.9663401096912767, -0.7208598648049378}, 1}, {{
    0.6246174906450612, -0.5981422560863225}, 1}, {{-0.43175884919360774`, 
    0.04935022628590113}, 2}, {{0.487222546935719, -0.8052255640135457}, 
    2}, {{0.4980915447104537, 0.1057991694742646}, 3}, {{-0.5317656753303184, 
    0.0947382111895676}, 4}, {{0.053959051997052754`, -0.05767305362064912}, 
    3}, {{-0.720103559377895, -0.8297727098925112}, 2}, {{-0.5474998671443099,
     0.7711270276818039}, 2}, {{0.9489272889717086, 0.5965921923576203}, 
    1}, {{-0.15592134333136531`, -0.6357984456180263}, 
    4}, {{-0.08653604800569381, -0.35096823065259874`}, 
    4}, {{-0.016477693154306028`, 0.40085521159619786`}, 4}, {{
    0.5300732275794724, -0.16394414050109862`}, 1}, {{-0.10015091677755761`, 
    0.8706505486833231}, 4}, {{0.2626964266480938, 0.6832896701686768}, 
    2}, {{-0.9196505993231345, -0.6558989658508119}, 4}, {{0.5918875246657822,
     0.7228204990567422}, 3}, {{0.9203411612279826, -0.8972135833437491}, 
    2}, {{-0.0910599121586042, 0.19827036085749672`}, 
    2}, {{-0.03219811782761939, -0.06520741968736621}, 4}, {{
    0.5079141913659289, 0.023163082477229757`}, 3}, {{0.35130431910511284`, 
    0.030593777859997395`}, 3}, {{-0.13865752714402646`, -0.0855071542143353},
     2}, {{0.033267388177625534`, -0.8193362104437858}, 
    4}, {{-0.800463760509623, -0.6082268985492632}, 4}, {{-0.5372475187192247,
     0.3602933038543883}, 3}, {{0.4536910587008167, 0.4290304423931244}, 
    4}, {{-0.6147733035218006, 0.4918810589976568}, 1}, {{
    0.19967858920373427`, 0.8096710276877612}, 3}, {{
    0.14391142474996288`, -0.817057985408733}, 3}, {{
    0.43521762429034627`, -0.5290633954043038}, 
    1}, {{-0.9981957945747149, -0.6001853351680793}, 3}, {{-0.268896538886616,
     0.5210554794954803}, 2}, {{0.84639161219738, 0.3480465867043776}, 
    1}, {{-0.30808193397689054`, -0.7176634749000019}, 4}, {{
    0.1272835902338585, 0.6022703747700504}, 4}, {{0.7970346607953074, 
    0.6897070784787442}, 3}, {{0.8188677109681706, 0.19096949996771428`}, 
    3}, {{-0.9406089502092527, -0.46739555533452526`}, 4}, {{
    0.6320569847337163, 0.6802461679776766}, 3}, {{-0.04866291462815342, 
    0.4967003920248305}, 1}, {{0.5356102862255252, 0.3831053862540035}, 
    4}, {{-0.9532101156308834, -0.1730403301214256}, 
    4}, {{-0.13626227383235623`, -0.9556343188170948}, 4}, {{
    0.41889373010285436`, 0.27288324550396226`}, 
    3}, {{-0.3188204820213656, -0.006489759268831552}, 3}, {{
    0.26615828290636045`, 0.12374818623046657`}, 
    3}, {{-0.48647977022049327`, -0.6124025862478697}, 
    4}, {{-0.6981508098732716, -0.7692856121504201}, 
    1}, {{-0.485069577931593, -0.6167788800320442}, 
    4}, {{-0.10085961522174403`, 0.40796305446347736`}, 
    3}, {{-0.33712787333423044`, -0.3536203039388939}, 1}, {{
    0.4898586199700721, -0.353532769246915}, 1}, {{-0.37955607519391865`, 
    0.07967039609072657}, 3}, {{0.11768754225617473`, -0.13956193015912266`}, 
    1}, {{-0.45677100058773545`, -0.7939688102555618}, 
    3}, {{-0.1725859851503646, 0.09353598154872955}, 2}, {{
    0.15063152774556565`, 0.7159174437753788}, 3}, {{
    0.9069202442537123, -0.8605343447363225}, 1}, {{0.9016663399697493, 
    0.06281149878472192}, 1}, {{-0.03647318266516697, -0.10381692528227138`}, 
    2}, {{-0.03285229536121337, -0.443414436019157}, 
    2}, {{-0.24700851051570982`, 0.45909827356970956`}, 2}, {{
    0.4776946677146827, -0.6819375628089528}, 1}, {{-0.4409030678903396, 
    0.935268513606307}, 4}, {{-0.9592362459573067, 0.29550842499114927`}, 
    1}, {{-0.12796300505208835`, 0.06288867162647627}, 2}, {{
    0.7843445158597686, -0.6209747256041909}, 1}, {{0.9545713047527653, 
    0.9188639147233681}, 3}, {{-0.1578393548115513, 0.9665713765570083}, 
    2}, {{-0.5575523043859598, -0.2172271287795513}, 2}, {{
    0.44217086798774297`, 0.6314768781580469}, 
    3}, {{-0.10499118249588868`, -0.5218731266539245}, 
    4}, {{-0.5767070700803254, -0.5967817586277495}, 4}, {{
    0.42701683428498693`, 0.440145150206801}, 3}, {{0.9062686190696692, 
    0.08063001551615834}, 4}, {{0.30069752233245906`, 0.5193292049268328}, 
    3}, {{0.08841376166765258, -0.12546878644878845`}, 
    1}, {{-0.47854499973280484`, -0.6474298001031542}, 4}, {{
    0.8306830557748639, -0.0746400311705746}, 
    3}, {{-0.08500815609204349, -0.3533541362072219}, 
    1}, {{-0.6803459110422412, -0.4662011154064163}, 4}, {{
    0.80054050071911, -0.7267900607597144}, 
    1}, {{-0.7435459915100018, -0.2906644352991008}, 4}, {{
    0.4782168245439187, -0.43563522215404094`}, 
    1}, {{-0.8115502481799721, -0.9091089397977261}, 4}, {{
    0.30600040609876356`, -0.3734811028869145}, 3}, {{0.5354361457586418, 
    0.6160527679720773}, 3}, {{0.5078892371515296, 0.3367404053820051}, 3}, {{
    0.12715861249987448`, -0.12638687797616655`}, 2}, {{
    0.8732520433112771, -0.24294510039508843`}, 3}, {{0.3759246102702054, 
    0.3242583723617454}, 4}, {{-0.7475961359046757, -0.7182710052587522}, 
    4}, {{0.8305283161869825, 0.8993531142356046}, 3}, {{0.9741285335048202, 
    0.06477753533580932}, 3}, {{-0.6640633259459445, -0.44134020746268243`}, 
    1}, {{-0.9953842924297662, 0.487141134599816}, 2}, {{0.36902974883896267`,
     0.9588983608604758}, 3}, {{0.8825493703739937, 0.4173734223997978}, 
    1}, {{-0.6045520610843598, -0.1752045825834223}, 
    3}, {{-0.9075142307312873, 0.8581687378396294}, 2}, {{
    0.8445753907917077, -0.42264364222641326`}, 4}, {{0.6793148057170546, 
    0.35753539954636615`}, 2}, {{-0.4188083120671009, -0.25395054353177215`}, 
    4}, {{0.4502436818985869, 0.7070843601234547}, 4}, {{0.9360008075746769, 
    0.20587361836558138`}, 3}, {{0.14476294473365314`, 0.5989454128874949}, 
    2}, {{-0.7079217261109565, 0.7734364963241034}, 2}, {{-0.5811782705688122,
     0.609592294516776}, 2}, {{-0.002338384883032063, 0.8007767881417087}, 
    3}, {{0.13539706928866613`, -0.5058333505088362}, 
    1}, {{-0.2785537459004015, 0.3675012539494156}, 2}, {{
    0.41248481769870926`, 0.022721862685446403`}, 3}, {{-0.5010941869508145, 
    0.2868538795930444}, 2}, {{-0.6353592448843739, 0.8038841592474952}, 
    4}, {{0.7728128497333908, -0.3619574637882317}, 
    1}, {{-0.28484948701932433`, 0.16459874626402948`}, 2}, {{
    0.03814813171989151, 0.3141203392342202}, 3}, {{-0.30044631762788, 
    0.5303327235347912}, 2}, {{0.2791235519911508, 0.6054222299768575}, 3}, {{
    0.39315858811220883`, 0.15869143547838638`}, 3}, {{0.8904610063933345, 
    0.17551434194507598`}, 3}, {{-0.8119379328231187, 0.24717849523143087`}, 
    2}, {{0.8544329223275495, 0.27189574056718735`}, 
    3}, {{-0.25749472984502875`, 0.5366030342992509}, 2}, {{
    0.35251497078551, -0.496090490863903}, 2}, {{-0.6109731020503664, 
    0.651365030233348}, 2}, {{-0.9337177546010893, 0.9752504689670225}, 1}, {{
    0.7383515640796894, 0.5599604655976989}, 
    1}, {{-0.4708986781390787, -0.11694970355226442`}, 4}, {{
    0.18089235381801227`, 0.45586954449193806`}, 4}, {{-0.9284428795988928, 
    0.09542630304817656}, 2}, {{-0.1277922285232589, -0.2630510053158237}, 
    1}, {{-0.09731921283807354, -0.8309884056696806}, 
    3}, {{-0.05215336207429466, -0.33631742107974505`}, 
    4}, {{-0.2865393744103253, -0.7978007338419033}, 4}, {{0.5299875868822008,
     0.6250253440467302}, 3}, {{0.034345828457953864`, 0.24437912195728773`}, 
    3}, {{0.8793298668302887, -0.9309197803086535}, 3}, {{
    0.4618532252217724, -0.5472029768226534}, 1}, {{0.5144199609881133, 
    0.3700539955224036}, 3}, {{-0.6470933406931261, 0.18392994673785967`}, 
    2}, {{-0.5931367079625449, 0.10146110341342052`}, 2}, {{
    0.8482310317892705, 0.2679801804383857}, 2}, {{-0.8983514270649535, 
    0.08544544686768196}, 4}, {{-0.33416248168944307`, -0.41320363500316226`},
     2}, {{0.6676263057227363, 0.44904795447522616`}, 3}, {{
    0.9001838613935327, -0.6471299436249445}, 4}, {{
    0.29997258329962007`, -0.3860972921506205}, 
    3}, {{-0.8563032815924938, -0.7814330165361394}, 1}, {{
    0.9169957271359923, -0.480248551293863}, 2}, {{-0.020645196901861063`, 
    0.7323692892076594}, 3}, {{0.20811198800925634`, -0.6589384395577467}, 
    1}, {{-0.8636164794485741, 0.03988580073274006}, 1}, {{0.5430576232487119,
     0.011325336093908067`}, 2}, {{-0.7032604025416864, -0.8329293926359367}, 
    4}, {{0.5364549829266725, -0.03011534155418616}, 
    4}, {{-0.7436177057151876, -0.7824924463859313}, 
    1}, {{-0.016354431228624566`, 0.286913987662647}, 4}, {{
    0.4010760908277389, 0.3393381922412755}, 3}, {{
    0.7257219498239729, -0.9316352217198864}, 4}, {{-0.22487105446761024`, 
    0.10284561995863095`}, 1}, {{0.17999940659408287`, 0.2951672429117074}, 
    3}, {{0.6458871318581476, 0.8391666093479389}, 
    2}, {{-0.14948586462437152`, 0.15917012019507482`}, 
    2}, {{-0.13546238692046542`, -0.9519366912953697}, 
    1}, {{-0.0874617031043674, -0.6666055573601319}, 
    4}, {{-0.9599003303970997, -0.7918462077066284}, 1}, {{
    0.087369563654903, -0.9195841683252737}, 3}, {{-0.54101805620894, 
    0.5279156962078515}, 4}, {{-0.38910647296704104`, -0.15084510985892008`}, 
    4}, {{0.11502429278388027`, 0.7317326383886504}, 
    3}, {{-0.11677602745540616`, 0.46068497114566087`}, 
    4}, {{-0.009540954368885579, 0.9945033518013986}, 
    2}, {{-0.44513722350065743`, -0.7160331237591149}, 2}, {{
    0.2242536077463213, -0.9379208442967268}, 1}, {{0.018311156483155955`, 
    0.13451606110926662`}, 3}, {{-0.45447220131272825`, -0.7527214439479466}, 
    3}, {{0.8486937236934633, 0.5758387148147128}, 
    3}, {{-0.7299834884013658, -0.9254609066087345}, 1}, {{
    0.7635556415571649, -0.6811977683310251}, 1}, {{
    0.38071506843205727`, -0.029820637139327033`}, 3}, {{
    0.452404253642698, -0.9167806690173723}, 3}, {{0.22812869173703687`, 
    0.5682214473104708}, 4}, {{-0.7055125476363622, 0.26182979929433126`}, 
    3}, {{-0.20874949139565846`, 0.33554092229402066`}, 4}, {{
    0.5039385070978568, 0.9602728771466129}, 3}, {{
    0.49855224456650804`, -0.8003441533872033}, 3}, {{
    0.009341686741263011, -0.5283098443393182}, 3}, {{0.3736167502657426, 
    0.012540746258792534`}, 1}, {{-0.4883820853266796, 0.614070832748359}, 
    3}, {{-0.9028168373504486, 0.5215020904215706}, 
    3}, {{-0.38615244525627235`, -0.1645492023239905}, 4}, {{
    0.6960519549681039, 0.22224150512035612`}, 3}, {{-0.6884010838708923, 
    0.05085905959461057}, 2}, {{0.004043542706945402, -0.6209523741233829}, 
    4}, {{0.4160083381284987, 0.6144293421387879}, 2}, {{
    0.3532452482088102, -0.4773028331677942}, 1}, {{
    0.48369650738260983`, -0.4487238710986974}, 4}, {{0.6707824859607356, 
    0.47161584905715603`}, 4}, {{0.9467352430567315, -0.551865060825286}, 
    3}, {{-0.6173727173365742, -0.15106802735901415`}, 
    4}, {{-0.07046884816329646, -0.75131323211057}, 1}, {{-0.8729128830830732,
     0.2593946927165547}, 2}, {{-0.5047467104721357, 0.4550050368197187}, 
    2}, {{0.266612099380922, 0.29115704698580647`}, 
    3}, {{-0.20071669596197328`, -0.03786566837973471}, 1}, {{
    0.9361510648194664, 0.3276367924810013}, 3}, {{-0.7912845838933853, 
    0.2546691507678709}, 2}, {{-0.18790597318233848`, 0.8564419113842177}, 
    2}, {{-0.9727690075610309, 0.468832038793606}, 
    2}, {{-0.9623682123205732, -0.43087522746703133`}, 
    4}, {{-0.9492374001340633, 0.4394545324720127}, 2}, {{-0.3350487841496532,
     0.6673217091327954}, 3}, {{-0.11795981817594958`, 0.6243902997239861}, 
    2}, {{-0.6655050640293019, 0.5623171927886932}, 
    2}, {{-0.26354235102316936`, 0.06017672576777855}, 
    2}, {{-0.1852640134618122, 0.4367261859977356}, 2}, {{
    0.5350241322664124, -0.41494171155667026`}, 
    1}, {{-0.029923198985839505`, -0.7302573124233955}, 3}, {{
    0.09236867551283723, 0.18171039710423287`}, 1}, {{
    0.2154961008541525, -0.1950675729302329}, 
    1}, {{-0.5895598841423286, -0.8385291262123156}, 
    4}, {{-0.9572479215478578, -0.9219817757243156}, 
    4}, {{-0.34124347915119513`, 0.3435921579560546}, 4}, {{
    0.8306214835210053, -0.9343193513873578}, 2}, {{-0.6505566610567302, 
    0.4643884985138378}, 2}, {{-0.10136058487708288`, -0.785788479469852}, 
    1}, {{-0.004619959876348556, -0.22032369637231142`}, 
    1}, {{-0.8160764981524946, 0.2596718503162365}, 4}, {{0.3102229191319492, 
    0.09201534804892697}, 4}, {{-0.06066930833424555, 0.8643286436100444}, 
    1}, {{-0.9706751862259546, -0.4502140281150333}, 4}, {{
    0.8059657348203566, -0.8623190783005112}, 1}, {{0.5162505416890832, 
    0.6188649164882545}, 3}, {{0.5812726443169609, 0.6319692375709556}, 4}, {{
    0.5533365769923368, 0.02949994962446434}, 
    3}, {{-0.013198301387162825`, -0.3021706900638539}, 
    4}, {{-0.8332284220519091, 0.6574133274944192}, 2}, {{0.1465925510291095, 
    0.42565645154638876`}, 3}, {{-0.48965059918869347`, -0.750511840883096}, 
    3}, {{-0.3694643185988924, -0.6285442045829157}, 
    4}, {{-0.15245945348826329`, -0.33408924251774064`}, 
    2}, {{-0.3014963421647243, -0.042769716407105474`}, 4}, {{
    0.05637899302680882, -0.17606866720851988`}, 1}, {{0.8777341906105911, 
    0.9941969752525037}, 3}, {{-0.8901534095330379, -0.306880850627993}, 
    4}, {{0.8809975940933983, 0.8940384109610213}, 1}, {{0.7316780433595498, 
    0.35007898627947487`}, 3}, {{0.19719283903963358`, -0.9924224143549556}, 
    1}, {{0.18229168648561567`, -0.3298519831857387}, 4}, {{
    0.9999044012864755, 0.39428906829274}, 3}, {{0.9809424012596195, 
    0.3843554340060966}, 2}, {{0.7058649100177306, -0.535916867577952}, 
    4}, {{-0.3227535235986019, -0.8447069170963162}, 
    3}, {{-0.7702700248770125, -0.4320047230774775}, 
    4}, {{-0.9322725670756262, -0.34581185221996114`}, 
    4}, {{-0.035023759072172034`, 0.22639809234848896`}, 2}, {{
    0.0485385688602884, -0.2899405126949923}, 4}, {{0.12694256497308665`, 
    0.1771368063189609}, 2}, {{0.703191327707311, 0.4746769177054069}, 
    3}, {{-0.5989117627147049, -0.5013428364853563}, 4}, {{0.8870876125057392,
     0.047480981345422446`}, 3}, {{-0.5332671330644918, 0.16025685323347671`},
     2}, {{0.8050051532406326, 0.7241798595860183}, 3}, {{0.2583933174346842, 
    0.3646439557986185}, 1}, {{-0.08943939835541093, 0.12291594744238887`}, 
    2}, {{0.5695329448336861, 0.28126399741692554`}, 3}, {{0.6380512106371663,
     0.043241749697041865`}, 3}, {{-0.10747409568956456`, 
    0.44364381148271814`}, 2}, {{-0.4702869120673867, 0.8079681676398853}, 
    1}, {{-0.36238165868083216`, -0.1375827733914674}, 4}, {{
    0.7993079375989751, 0.08066245742346645}, 4}, {{-0.8166128425044481, 
    0.5384458932586211}, 2}, {{0.48267297376812746`, 0.34805847310665383`}, 
    3}, {{-0.015452037703760801`, -0.275214255096381}, 
    1}, {{-0.8292669586096806, 0.9554260315493477}, 
    2}, {{-0.8006298157603133, -0.6074247889075806}, 
    4}, {{-0.20799533858597696`, -0.22976908546440455`}, 
    4}, {{-0.870622052461155, 0.4523401569838277}, 2}, {{-0.8027240227442953, 
    0.32732511129952435`}, 2}, {{-0.16386679896659118`, 0.37331723050818244`},
     3}, {{-0.027901640868516875`, -0.502256985803692}, 
    3}, {{-0.12484039731799923`, 0.049277981059641984`}, 
    3}, {{-0.1760000822491703, 0.3186111102263922}, 2}, {{
    0.38028990789581574`, -0.38258963019128966`}, 1}, {{
    0.12144402339572036`, -0.2649043446488659}, 1}, {{
    0.9944900520475515, -0.2793396402280468}, 1}, {{-0.9886276751164091, 
    0.22853135152500137`}, 2}, {{0.3840990400809159, 0.7679109601964469}, 
    3}, {{-0.8006966808898515, 0.5820492508548032}, 2}, {{0.8335995230091702, 
    0.6856522576485169}, 1}, {{0.9499091036528609, -0.5988906730929555}, 
    1}, {{-0.3286257578812535, -0.21007353041661725`}, 2}, {{
    0.35520174489335954`, -0.020170938627468882`}, 4}, {{-0.5518109118925607, 
    0.8308175498981254}, 4}, {{-0.25647981724813906`, -0.2532481290811148}, 
    1}, {{0.30657109122283854`, 0.7456111066425364}, 
    3}, {{-0.5862307908566979, 0.957201091093979}, 3}, {{0.1622146761992238, 
    0.10353328853681498`}, 3}, {{0.8898278705533325, 0.3260187761017419}, 
    4}, {{-0.35900041045561837`, -0.5728967044103164}, 
    1}, {{-0.19485966759365514`, 0.00698853590813453}, 2}, {{
    0.37186575608174754`, -0.6790308004295076}, 
    1}, {{-0.5200414353543481, -0.6732791157354194}, 
    2}, {{-0.7996138452778623, 0.5801213301960022}, 
    1}, {{-0.2189980653629675, -0.5499189517980114}, 
    2}, {{-0.40161381803679896`, 0.028934907610028926`}, 3}, {{
    0.5415612762452988, -0.9139755958942062}, 3}, {{0.3388994023547447, 
    0.5625653014901348}, 3}, {{0.32183681345843995`, -0.052426699813552524`}, 
    2}, {{-0.6479340819116675, 0.7095886880613178}, 
    3}, {{-0.3417330288424987, -0.680546773940824}, 4}, {{
    0.5686752060621147, -0.8600153139259801}, 
    1}, {{-0.9133889848156387, -0.8748415942917185}, 4}, {{
    0.9433567671337739, -0.5694879245967344}, 
    1}, {{-0.7286471498991709, -0.4235003331224223}, 4}, {{
    0.6931243411119707, -0.8387955844478197}, 1}, {{
    0.5799099185787329, -0.4585407565172832}, 1}, {{-0.8896274251516405, 
    0.4849108867467642}, 2}, {{-0.4131730229544446, 0.4523087258200782}, 
    3}, {{0.5636475017672864, 0.7842165209973846}, 3}, {{-0.8242747017377723, 
    0.980560464904924}, 1}, {{0.4721512870738316, 0.5773440083694177}, 
    3}, {{-0.0906134805271912, 0.7843477418712728}, 3}, {{
    0.8657823372489357, -0.9881413543589073}, 1}, {{
    0.10637989464424846`, -0.8706146733807834}, 1}, {{-0.08226996411234122, 
    0.4444417606738251}, 1}, {{-0.7527698660310804, -0.15100200908367567`}, 
    4}, {{0.16448788531004555`, 0.7017562602629877}, 3}, {{
    0.4943909178479151, -0.5406769311065895}, 
    1}, {{-0.693204405744702, -0.3240053838053374}, 
    3}, {{-0.39211804431239594`, -0.12266301045871542`}, 4}, {{
    0.062270874276092236`, -0.11193049387043663`}, 3}, {{0.9856111722809513, 
    0.9534761224789499}, 1}, {{-0.25766066949043775`, 0.2620423513282284}, 
    2}, {{-0.2053139392586094, -0.47331062473731844`}, 4}, {{
    0.9026281713395612, 0.6541389709083476}, 
    3}, {{-0.05653423618288489, -0.37600865077010104`}, 4}, {{
    0.5854812285973487, 0.7912921346396828}, 3}, {{
    0.06836459757120084, -0.9728797980570962}, 2}, {{-0.5122395293959996, 
    0.38980029695361873`}, 2}, {{-0.33252322957330094`, -0.6964634924521458}, 
    1}, {{-0.22717477103064, -0.5676158162523297}, 3}, {{
    0.8646172843532813, -0.043553516105868884`}, 1}, {{-0.9934894086597477, 
    0.4604949407304928}, 2}, {{0.7312218939594763, 0.7325098663737193}, 
    3}, {{-0.32476890307354367`, 0.3978243915296149}, 
    2}, {{-0.5652221467876983, -0.014298010613887246`}, 
    4}, {{-0.6959092615975093, 0.514620465538917}, 
    3}, {{-0.004450525486308532, 0.6830450556881456}, 3}, {{
    0.33951111972649395`, -0.7976888509686044}, 2}, {{-0.5881767604667036, 
    0.7693651081242163}, 3}, {{-0.10244001789630719`, 0.03195425929589524}, 
    2}, {{0.6364395206436493, -0.4488173111451146}, 1}, {{-0.7457881067084999,
     0.7895258676442847}, 3}, {{-0.9509021464049487, 0.6677248264799092}, 
    4}, {{0.2838520184385098, 0.3310203222335253}, 3}, {{-0.4540739996504204, 
    0.13078999600380836`}, 1}, {{-0.0030631449914868547`, 
    0.48444906639490837`}, 2}, {{0.13718457824291042`, -0.5676011885608601}, 
    2}, {{-0.7974838375612876, 0.20081273211445927`}, 
    2}, {{-0.4307882582974547, 0.23895691765159777`}, 2}, {{
    0.2913284834705876, 0.5234800880248498}, 
    2}, {{-0.47723459670553847`, -0.827460276343813}, 2}, {{
    0.15784400490089778`, 0.6285663662808108}, 4}, {{0.8290379505167014, 
    0.588848141286828}, 3}, {{0.8625377011805568, 0.8436937097728112}, 1}, {{
    0.19193175391671113`, 0.6417972539701089}, 3}, {{-0.9700175547830376, 
    0.5044407150018175}, 4}, {{-0.9090819426578758, -0.7244992554755032}, 
    4}, {{-0.24152532998434495`, 0.0340523524641303}, 
    2}, {{-0.2332387547895194, -0.10269851294371923`}, 
    4}, {{-0.7342722037794216, -0.5439790409057981}, 1}, {{
    0.46027394000211697`, 0.33792507605564026`}, 
    4}, {{-0.5604338313948278, -0.677741835835886}, 2}, {{
    0.14143668551932187`, 0.6786305828818797}, 1}, {{
    0.2296012412002879, -0.6585538585097437}, 
    4}, {{-0.1867020838281288, -0.7216275226068394}, 
    4}, {{-0.4725724149179391, -0.1604494191398853}, 2}, {{0.4487504222266061,
     0.6657947946261946}, 1}, {{0.2838919402075599, -0.4951564150298804}, 
    4}, {{0.4292674268039214, 0.5061736822577796}, 1}, {{0.6270147824968002, 
    0.1541017654935195}, 3}, {{0.5978824822798106, 0.7373955754111443}, 
    3}, {{-0.11466575238938592`, -0.23818760251430549`}, 3}, {{
    0.37016577068068557`, 0.3051709772593836}, 
    3}, {{-0.2169631981366149, -0.6610203682208469}, 
    1}, {{-0.4229206560258172, 0.4486175862820412}, 4}, {{-0.6037581561556222,
     0.35121951384328565`}, 2}, {{0.875967306000522, 0.4133393760693309}, 
    2}, {{0.7541188769070906, -0.1392830909483771}, 2}, {{0.03943676606921631,
     0.4790960018052024}, 4}, {{-0.43389785183625884`, 0.4624322133446519}, 
    4}, {{-0.4560459239373431, -0.9573213942458869}, 4}, {{
    0.4988491012673242, -0.5299739208712282}, 
    4}, {{-0.37636901389633737`, -0.533218629140304}, 4}, {{
    0.647621696759586, -0.7488464006364155}, 1}, {{0.039505922295754115`, 
    0.6173084160806934}, 3}, {{0.48992634227324583`, -0.3454145831646134}, 
    4}, {{-0.6718207686251292, -0.6750335637068656}, 4}, {{
    0.4126331159004182, -0.8733678047945577}, 1}, {{
    0.7484278360625871, -0.7107952969161997}, 1}, {{0.22052671394286794`, 
    0.44794460195880914`}, 2}, {{0.6506977784399686, -0.6616976822503502}, 
    4}, {{0.6795871156606403, -0.1377640709567527}, 1}, {{
    0.1335439262188327, -0.9044986537059247}, 1}, {{
    0.7556290637163992, -0.8225705481096077}, 1}, {{0.834377126090327, 
    0.0564711696568545}, 3}, {{0.10157167944865941`, 0.24075600752252324`}, 
    1}, {{0.6231153901851907, 0.39329752303958365`}, 
    1}, {{-0.0017350807592726447`, 0.8988603920968661}, 2}, {{
    0.8200034158216529, 0.46127539378529425`}, 3}, {{
    0.8973445537413491, -0.9532773115986544}, 1}, {{-0.8667801173663454, 
    0.18821641811625556`}, 2}, {{-0.01783102540353987, -0.30910693243164555`},
     4}, {{-0.40098927413714724`, -0.6092279677394465}, 2}, {{
    0.01840827079542562, 0.8032972553043405}, 3}, {{0.027006958265115788`, 
    0.11689829628632831`}, 2}, {{-0.47200409966863077`, -0.2646692010346623}, 
    4}, {{-0.7290015760143334, 0.2581372988976618}, 3}, {{
    0.25581660069223044`, -0.7198559357329941}, 3}, {{
    0.12454199535050758`, -0.25399897459308063`}, 1}, {{-0.13984447431078184`,
     0.3198549871230232}, 1}, {{-0.470200600133829, 0.35724785454445973`}, 
    1}, {{-0.8859736677187171, -0.0764150999659452}, 4}, {{
    0.7871663216970362, -0.7532611750359348}, 2}, {{
    0.1645186370284657, -0.2689502226916556}, 1}, {{0.6363708548372289, 
    0.23419499163410595`}, 4}, {{-0.17961213630119222`, 0.35339011612167504`},
     4}, {{0.6388208705533538, 0.7571482645365348}, 3}, {{
    0.32752748513013863`, 0.29544334188266586`}, 3}, {{0.5750291181277589, 
    0.16831579709198685`}, 1}, {{0.51068924764831, 0.8272909054648014}, 3}, {{
    0.21812523980483922`, -0.2671271948555112}, 4}, {{
    0.893436774260528, -0.2206390351429266}, 
    1}, {{-0.9674399933972126, -0.8589176532467966}, 
    4}, {{-0.7746719476637587, 0.8220856625352329}, 2}, {{-0.4799857582328553,
     0.23500517444784164`}, 2}, {{0.741826936875325, 0.021229150574400446`}, 
    3}, {{-0.6499613788523648, 0.06802012722245676}, 1}, {{0.3213690376120777,
     0.16929758036703646`}, 1}, {{0.8284572150747049, 0.6358518968134987}, 
    3}, {{0.5958638973154327, 0.09447583841027907}, 3}, {{0.2571533954843024, 
    0.7312998135795605}, 3}, {{-0.09498359856654659, -0.76589790220787}, 
    3}, {{-0.8304230680907079, 0.03772997310814574}, 
    4}, {{-0.7059894468362709, 0.1926796354065261}, 
    2}, {{-0.5738453146885192, -0.539420659519465}, 2}, {{
    0.08555094515793327, -0.17045886517931175`}, 
    1}, {{-0.9689819655677114, -0.5407941873366231}, 
    4}, {{-0.10885135109150745`, -0.060841951172411424`}, 4}, {{
    0.6681138271303029, -0.6475346329989846}, 
    4}, {{-0.006389742140624488, -0.20118351977207372`}, 2}, {{
    0.05800356271377449, -0.2637249405389146}, 
    1}, {{-0.014418807539857692`, -0.16466194288225156`}, 4}, {{
    0.9889042717170566, -0.27789253760860033`}, 1}, {{-0.6317805839079917, 
    0.3538893135342276}, 2}, {{0.8634139718867462, -0.03984772159848271}, 
    2}, {{0.868863541317896, 0.8434307744537111}, 4}, {{0.5221155438050866, 
    0.5620858616639333}, 3}, {{0.2805522265005842, -0.8964704739450351}, 
    1}, {{0.4752187647185093, 0.8910995260811845}, 3}, {{-0.9406474308552628, 
    0.7192374556511916}, 2}, {{-0.7283979954571462, -0.7965130939757397}, 
    4}, {{0.07159757864017768, 0.7165404353048568}, 3}, {{0.4363775300081625, 
    0.25036666512960526`}, 1}, {{-0.7967036415650286, 0.9722535232527503}, 
    2}, {{-0.15984657636027944`, 0.5387983819411941}, 1}, {{
    0.06109772083680465, 0.8600171469282247}, 3}, {{
    0.6121255442160476, -0.22812303560402736`}, 4}, {{-0.8067824934425754, 
    0.06793967232854703}, 1}, {{-0.9266692271863333, 0.9738169653814084}, 
    2}, {{-0.5361303479122772, -0.12585855615782826`}, 2}, {{
    0.3308693222480148, 0.6583753091223636}, 
    3}, {{-0.7262461465547347, -0.4470654630781694}, 
    4}, {{-0.1694531545828899, 0.7471149745265349}, 2}, {{0.4613072213901135, 
    0.46426542807744253`}, 2}, {{-0.13460688961537848`, 0.00544446917009811}, 
    2}, {{0.5403541029743315, 0.20658667607661663`}, 
    3}, {{-0.9870914471883441, -0.5572757051285588}, 
    2}, {{-0.7187117796959286, -0.061975765858009346`}, 
    2}, {{-0.5356261045624806, 0.25584159458438327`}, 
    2}, {{-0.13144879694574207`, -0.8797830500197548}, 2}}}, 
  DynamicBox[ToBoxes[
    Refresh[
    If[$CellContext`t$$ < 
       0, $CellContext`actors$$ = $CellContext`initialize[]; $CellContext`t$$ = 
        0, 
       Do[$CellContext`actors$$ = $CellContext`update[$CellContext`actors$$]; \
$CellContext`t$$ = $CellContext`t$$ + 
          1, $CellContext`steps]]; $CellContext`draw[$CellContext`actors$$, \
$CellContext`t$$], TrackedSymbols -> {}, 
     UpdateInterval -> $CellContext`updateInterval], StandardForm],
   ImageSizeCache->{450., {221., 228.}}],
  DynamicModuleValues:>{}]], "Output",
 CellChangeTimes->{
  3.680636174382432*^9, 3.6807857185255203`*^9, 3.6807857549803534`*^9, 
   3.6807860055316277`*^9, 3.680786088997257*^9, {3.680786648787817*^9, 
   3.680786689924323*^9}, 3.6807868021909103`*^9, 3.680906240032667*^9, 
   3.68090771899734*^9, 3.680907786498644*^9, 3.680907905427024*^9, 
   3.6809079908334017`*^9, 3.680911054347467*^9, {3.6809139454933367`*^9, 
   3.680913953815404*^9}, 3.680914025059142*^9, {3.680914473718848*^9, 
   3.6809144863113203`*^9}, 3.680914557288168*^9, {3.680914612182089*^9, 
   3.680914630794684*^9}, 3.680914974199853*^9, 3.680915012696101*^9, 
   3.6809153749960413`*^9, 3.680915431166181*^9, {3.6809155740063267`*^9, 
   3.680915592568161*^9}, 3.6809159728985033`*^9, 3.680916023075118*^9, {
   3.680916075416047*^9, 3.680916141511237*^9}, {3.680962909617331*^9, 
   3.680962915383402*^9}, 3.680962967262455*^9, {3.680963065583469*^9, 
   3.680963101762697*^9}, {3.6809631325675297`*^9, 3.680963151663651*^9}, {
   3.6809646901776533`*^9, 3.6809647050706577`*^9}, {3.680968266851104*^9, 
   3.68096833637292*^9}, {3.68097065455975*^9, 3.680970674929265*^9}, 
   3.680970735352639*^9, 3.6809737636585503`*^9, 3.680978356495421*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1183, 1296},
WindowMargins->{{Automatic, 321}, {Automatic, 0}},
FrontEndVersion->"11.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (July 28, \
2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 198, 3, 114, "Title"],
Cell[781, 27, 446, 8, 61, "Text"],
Cell[CellGroupData[{
Cell[1252, 39, 105, 1, 81, "Chapter"],
Cell[1360, 42, 999, 18, 39, "Input"],
Cell[2362, 62, 464, 8, 39, "Input"],
Cell[2829, 72, 145, 3, 39, "Input"],
Cell[2977, 77, 480, 11, 39, "Input"],
Cell[3460, 90, 487, 12, 39, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3984, 107, 151, 2, 81, "Chapter"],
Cell[4138, 111, 471, 11, 39, "Input"],
Cell[4612, 124, 649, 14, 66, "Input"],
Cell[5264, 140, 328, 9, 39, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5629, 154, 99, 1, 81, "Chapter"],
Cell[5731, 157, 809, 17, 39, "Input"],
Cell[6543, 176, 563, 13, 39, "Input"],
Cell[7109, 191, 482, 12, 39, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7628, 208, 142, 2, 81, "Chapter"],
Cell[CellGroupData[{
Cell[7795, 214, 115, 1, 80, "Section"],
Cell[7913, 217, 563, 12, 39, "Input"],
Cell[8479, 231, 674, 18, 39, "Input"],
Cell[9156, 251, 361, 10, 39, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9554, 266, 105, 1, 80, "Section"],
Cell[9662, 269, 673, 16, 66, "Input"],
Cell[10338, 287, 648, 17, 66, "Input"],
Cell[10989, 306, 1396, 30, 66, "Input"],
Cell[CellGroupData[{
Cell[12410, 340, 164, 4, 39, "Input"],
Cell[12577, 346, 234, 5, 39, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12848, 356, 182, 4, 39, "Input"],
Cell[13033, 362, 236, 5, 39, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13306, 372, 69, 1, 39, "Input"],
Cell[13378, 375, 235, 5, 39, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[13674, 387, 142, 2, 81, "Chapter"],
Cell[13819, 391, 519, 12, 63, "Input"],
Cell[14341, 405, 478, 13, 39, "Input"],
Cell[14822, 420, 247, 6, 39, "Input"],
Cell[15072, 428, 375, 8, 39, "Input"],
Cell[15450, 438, 699, 12, 39, "Input"],
Cell[16152, 452, 358, 7, 39, "Input"],
Cell[16513, 461, 813, 14, 39, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17363, 480, 140, 2, 81, "Chapter"],
Cell[17506, 484, 177, 4, 37, "Text"],
Cell[CellGroupData[{
Cell[17708, 492, 1734, 39, 248, "Input"],
Cell[19445, 533, 28399, 435, 467, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

